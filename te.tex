\documentclass[11pt,letterpaper]{article}

% PAQUETES ++++++++++++++++++++++++++++++++
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\pagenumbering{arabic}
\usepackage[pdftex]{graphicx}
\usepackage{tabularx}
\usepackage{tcolorbox}
\usepackage{array}
\usepackage{url}
\usepackage{relsize}
\usepackage{multirow}
\usepackage{float}
\usepackage{tabularray}
\tcbuselibrary{most}
\decimalpoint

%+++++++++++++++++++++++++++++++++++++++++++++++++++
\graphicspath{ {./img/}}
\pagenumbering{arabic}
\newtcolorbox{matlab-code}[2][]{colback=red!3!white, colframe=red!75!black, colbacktitle=red!75!black, enhanced, attach boxed title to top center={yshift=-2mm}, title={#2}, #1}



% +++++++++++++++++++++
\begin{document}
\title{Trabajo de Investigación: Ajuste de Curvas por Mínimos Cuadrados}

\author{
	Alberto Ramos Cruz
	\and Moisés Alonso Marroquín Ayala
	\and René Eduardo Hernández Castro
	\and Roberto José Melgares Zelaya
}
\maketitle


\section{Regresión lineal por mínimos cuadrados}
\subsection{Ajuste de una recta por regresión por mínimos cuadrados}

%---------------
%PUNTO 1 B // RENE
%---------------
\subsection{Linealización de relaciones no lineales}
Una función $y$ se puede formar mediante la combinación de múltiples funciones lineales $f_1$,$f_1$,\dots,$f_n$y la minimización de la suma de los cuadrados de las diferencias entre la predicción del modelo y los datos generados en un sistema lineal de ecuaciones para los coeficientes del modelo. Si se construye de esta forma "y" es lineal en sus coeficientes. En este caso analizaremos la posibilidad de convertir relaciones no lineales a su forma lineal de forma similar al método descrito anteriormente.\cite{ualberta} Consideraremos los siguientes modelos:
\begin{itemize}
	\item Modelo Exponencial $y = \alpha e^{\beta x}$
	\item Modelo Exponencial $y = \alpha x^{\beta}$
\end{itemize}
\par Este tipo de modelos no lineales en $x$ y sus coeficientes desconocidos $\beta$ y $\alpha$ se pueden transformar en modelos no lineales mediante el uso de logaritmo natural. Aplicando logaritmo natural a los modelos nos queda:
\begin{itemize}
	\item Modelo Exponencial ($y = \alpha e^{\beta x}$) $\longrightarrow$ $\beta x + \ln \alpha$
	\item Modelo Exponencial ($y = \alpha x^{\beta}$) $\longrightarrow$ $\beta \ln x + \ln \alpha$
\end{itemize}
\par 
En el caso del modelo exponencial se puede convertir como $(x_i, \ln(y_i))$ y con ello se puede hacer uso de la regresión lineal  para encontrar los coeficiente $\beta$ y $\alpha$. Para el caso del modelo potencial la información se puede expresar como $(\ln(x_i), \ln(y_i))$ y nuevamente hacer uno de la regresión lineal para encontrar los coeficientes $\beta$ y $\alpha$.\cite{ualberta}\cite{nieves2011metodos} 

\subsubsection{Coeficiente de determinación para relaciones no lineales}
Para determinar que tan los datos se ajustan al modelo se hará uso del ``coeficiente de determinación'' , si bien este coeficiente puede variar dependiente que software o articulo se esta obteniendo, en nuestro caso haremos uso de lo siguiente:
\begin{equation}\label{equation:coeficiente}
	R^2 = 1 - \frac{\sum_{i=1}^{n} (y_i - y(x_i ) ^2 }
	{\sum_{i=1}^{n} (y_i)^2}
\end{equation}

Donde $R^2$ es equivalente a 1 menos el coeficiente entre la suma de cuadrados del modelo y la suma total de cuadrados de los datos. Esta definición de $R^2$ es la mas común usada para modelos no lineales. Para describir dicha definición y lo descrito anteriormente para convertir ambos modelos exponencial y potencial en relaciones líneas se hará los siguientes ejemplos:

\subsubsection{Método Exponencial}
Haremos un ajuste de modelo exponencial y potencial para la siguiente lista de datos: (1,1.93), (1.1,1.61), (1.2,2.27), (1.3,3.19), (1.4,3.19), (1.5,3.71), (1.6,4.29), (1.7,4.95), (1.8,6.07), (1.9,7.48), (2,8.72), (2.1,9.34), y (2.2,11.62). \par
Recordando la forma exponencial, $y = \alpha e^{\beta x}$, es posible linealizarla mediante el uso de logaritmo natural para obtener la forma $\beta x + \ln \alpha$ y convertir una serie de datos a $(x_i, \ln(y_i))$. En el caso del modelo potencial, recordando su forma $y = \alpha e^{\beta x}$, se debe de linealizar también haciendo uso de logaritmo natural obteniendo $\beta \ln x + \ln \alpha$ , con ello convertiremos los datos a la forma final $(\ln(x_i), \ln(y_i))$. \textit{Esta oracion en adelante se ira} El procedimiento a continuación se realizará con los datos expresados para un caso de modelo exponencial, pero el procedimiento es el ``mismo'' para ambos modelos, cambiando únicamente su anotación final como veremos más adelante. Expresaremos los datos en formato de tabla para un mejor entendimiento, quedando de la siguiente manera. Se hará uso de $y*$ para representar $\ln(y_i)$
\begin{table}[H]
	\centering
	\begin{tabular}{c | c}
	\hline
		$x_i$ & $y_i$ \\ \hline
        1	& 0.6575 \\
        1.1	& 0.4762 \\
        1.2	& 0.8198 \\
        1.3	& 1.16 \\
        1.4	& 1.16 \\
        1.5	& 1.311 \\
        1.6	& 1.4563 \\
        1.7	& 1.5994 \\
        1.8	& 1.8034 \\
        1.9	& 2.0122 \\
        2	& 2.1656 \\
        2.1	& 2.2343 \\
        2.2	& 2.4527 \\ \hline
	\end{tabular}
\end{table}
Mediante el uso de regresión lineal es posible expresar $y*$ como: \textbf{$y* = \beta^* x + \alpha^*$ 	} obtendremos los coeficientes $\alpha^*$ y $\beta*$ de la siguiente manera:
\begin{align*}
	b^* &= \frac{n \sum_{i=1}^{n} x_iy_i^* - \sum_{i=1}^{n} x_i \sum_{i=1}^{n} y_i^*}{n\sum_{i=1}^{n} x_i^2 - (\sum_{i=1}^{n}  x_i)^2} \\
	a^* &= \frac{\sum_{i=1}^{n} y_i^* - b^* \sum_{i=1}^{n} x_i  }{n} \\
\end{align*}
Para el modelo potencial, es necesario sustituir los valores $x_i$ en la formula por las $x^*$ que corresponden a la evaluación de $\ln(x_i)$.
\par Con la siguiente tabla obtenemos los datos para utilizar en los cálculos de las ecuaciones anteriores
\begin{table}[H]
	\centering
	\begin{tabular}{c | c | c | c}
		$x_i$ & $y^*$ &	$X_iy^*$ & \\ \hline
		1.00 & 	0.6575 &	0.6575	& 1.000 \\
1.10 & 	0.4762 &	0.5239	& 1.2100 \\
1.20 & 	0.8198 &	0.9837	& 1.4400 \\
1.30 & 	1.1600 &	1.5080	& 1.6900 \\
1.40 & 	1.1600 &	1.6240	& 1.9600 \\
1.50 & 	1.3110 &	1.9665	& 2.2500 \\
1.60 & 	1.4563 &	2.3301	& 2.5600 \\
1.70 & 	1.5994 &	2.7190	& 2.8900 \\
1.80 & 	1.8034 &	3.2460	& 3.2400 \\
1.90 & 	2.0122 &	3.8232	& 3.6100 \\
2.00 & 	2.1656 &	4.3312	& 4.000 \\
2.10 & 	2.2343 &	4.6920	& 4.4100 \\
2.20 & 	2.4527 &    5.3960	& 4.8400 \\ \hline
Total= 20.8000 &	Total=19.3085	& Total=33.8013	& Total=35.1000 \\ \hline
	\end{tabular}
\end{table}
Con lo anterior obtenemos los valores  de $\beta$ y $\alpha$ los cuales son $-1.0709$ y $1.5976$, respectivamente.
%---------------
%PUNTO 2
%---------------
\section{Aproximación polinomial con mínimos cuadrados}
Con el fin de encontrar un modelo matemático que represente lo mejor posible a una serie de datos experimentales, es posible abordarlo por medio de una curva $y=\phi(x)$ que se aproxime a los datos, sin la necesidad de que esta curva pase por ellos.
Lo anterior plantea el problema de verificar que en los términos:
$\{(x_i, y_i)\quad i = 0,1,2,3, \cdots, N\} $ se debe de hallar un $\phi(x)$ que verifique

$$Minima = \sum_{i=0}^{N} (y_i - \phi(x_i))^2$$

Para evitar problemas se suele utilizar una diferencia cuadrada para evitar problemas de derivabilidad. 
\subsection{Parábola de mínimos cuadrados}
La parábola de mínimos cuadrados tiene como objetivo aproximar un conjunto de puntos 
$(x_0, y_0),$ $(x_1, y_1),$ $ (x_2, y_2),$ $ \cdots , (x_n, y_N)$, donde $N$ es el número de elementos en el conjunto de puntos, 
a través de una curva polinomial de grado 2. Entonces, podemos entender la parábola de mínimos cuadrados como una curva de $y=\phi(x)$ donde $\phi(x)$ es un polinomio de segundo grado que viene dado por la ecuación
$$y = a_0 + a_1 x + a_2 x^2  $$
donde $a_0, a_1, a_2 \in R$ y se determinan resolviendo las ecuaciones simultaneas : 

\begin{equation} \label{eq:sist-parab} 
	\left\{
		\begin{array}{@{}l@{}}
			\sum_{i=0}^{N} y_i  = a_0N + a_1\sum_{i=0}^{N} x_i + a_2\sum_{i=0}^{N} x_i^2 \cr\cr
			\sum_{i=0}^{N} x_iy = a_0\sum_{i=0}^{N} x_i + a_1\sum_{i=0}^{N} x_i^2 + a_2\sum_{i=0}^{N} x_i^3 \cr\cr
			\sum_{i=0}^{N} x_i^2y = a_0\sum_{i=0}^{N} x_i^2 + a_1\sum_{i=0}^{N} x_i^3 + a_2\sum_{i=0}^{N} x_i^4 		
		\end{array}
	\right.
\end{equation}
\linebreak 
Las ecuaciones anteriores  son conocidads como \textit{ecuaciones normales de mínimos cuadrados}. Estas ecuaciones se obtienen al multiplicar la ecuación $y = a_0 + a_1 x + a_2 x^2  $ por  1, $x$, y $x^2$, respectivamente. Como se puede observar, se obtiene un \emph{sistema con 3 incógnitas y 3 ecuaciones.}
\par
Para obtener los valores que acompañan a las incógnitas $a_i$ en el sistema de ecuaciones se debe de obtener la suma de los productos, tomando en cuenta los valores respectivos de $x_i$ con sus imágenes en $y_i$; esto a excepción del valor $N$ que acompaña a la incógnita $a_0$ en la primera ecuación como se puede observar en la Ecuación \ref{eq:sist-parab}.
\par
A continuación, se procede a resolver el sistema de ecuaciones por medio de una matriz de 4$\times$3 para que de esste modo se obtengan los valores de las 3 incógnitas. \cite{spiegel}\cite{nieves2011metodos} En este caso, se puede usar cualquier método de resolución de sistemas de ecuaciones por medio de matrices, aunque para esta investigación se hará uso del método de Cramer. \emph{ Con el objetivo de mejorar la comprensión lectora, a partir de este punto se usará la siguiente notación.}

 \begin{table}[H]
 \centering
	\begin{tabular}{ c | c }
	\hline
	Símbolo & Significado  \\ \hline
	$X$ &	$\mathlarger{\Sigma} x_i$  \\ 
	$Y$ &   $\mathlarger{\Sigma} y_i$ \\
	$X^2$ & $\mathlarger{\Sigma} x_i^2$ \\
	$X^3$ & $\mathlarger{\Sigma }x_i^3$ \\ 
	$X^4$ & $\mathlarger{\Sigma} x_i^4$ \\
	$XY$ &  $\mathlarger{\Sigma} x_i y_i$	\\
	$X^2Y$& $\mathlarger{\Sigma} x^2_i y_i$	\\ \hline
	\end{tabular}
	\label{table:simbologia}
\end{table}

Usando la notación anterior, pasamos a resolver la matriz y obtener las ecuaciones que nos dan los determinantes. \emph{Recordar que estas matrices no contienen variables simbólicas, sino que valores escalares representados con letras mayúsculas.}
\begin{table}[H] \centering \begin{tabular}{c c c c c}
%% resolucion a0
$a_0 = \frac{
		\begin{vmatrix}
		 	Y &	X	& X^2 \\
		 	XY &	X^2	& X^3 \\
		 	X^2Y & X^3 & X^4	 
		\end{vmatrix}}
		{\begin{vmatrix}
		 	N &	X	& X^2 \\
		 	X &	X^2	& X^3 \\
		 	X^2 & X^3 & X^4	 
		\end{vmatrix}}
		
$ & &
% resolucion a1
$ a_1 = \frac{
		\begin{vmatrix}
		 	N &	Y	& X^2 \\
		 	X &	XY	& X^3 \\
		 	X^2 & X^2Y & X^4 
		\end{vmatrix}}
		{\begin{vmatrix}
		 	N &	X	& X^2 \\
		 	X &	X^2	& X^3 \\
		 	X^2 & X^3 & X^4	 
		\end{vmatrix}}
$ & &
% resolucion a2
$ a_2 = \frac{
		\begin{vmatrix}
		 	N &	X	& Y \\
		 	X &	X^2	& XY \\
		 	X^2 & X^3 & X^2Y 
		\end{vmatrix}}
		{\begin{vmatrix}
		 	N &	X	& X^2 \\
		 	X &	X^2	& X^3 \\
		 	X^2 & X^3 & X^4	 
		\end{vmatrix}}
$ \\
\end{tabular} \end{table}
%% PROBLEMA 4
\subsubsection{Ejercicio propuesto usando el método de la parábola de mínimos cuadrados}
A continuación se presenta el siguiente problema:
\begin{center}
	\textbf{\textit{Problema 4:}} En la investigación de accidentes automovilísticos, el tiempo total requerido para el frenado total de un automóvil después de que el conductor ha percibido un peligro está compuesto de su tiempo de reacción (el tiempo que transcurre en su detección del peligro y la aplicación de los frenos) más el tiempo de frenado (el tiempo que tarda el automóvil en detenerse después de la aplicación de los frenos). La siguiente tabla proporciona la distancia de frenado D en metros de un automóvil que viaja a diversas velocidades V en metros por segundo al momento en el cual el conductor detecta un peligro.
	\linebreak\par
	\begin{tabular}{|c|c|c|c|c|c|c| }
		\hline
		Velociad V(m/s) &   20 & 30 & 40 & 50 & 60 & 70 \\
		\hline
		Distancia de frenado D(m) & 54 & 90 & 138 & 206 & 292 & 396 \\
		\hline
	\end{tabular}
	\begin{itemize}
		\item \textbf{a)} Encontrar la ecuación de la parábola de mínimos cuadrados que ajuste esta serie de datos.
		\item \textbf{b)} Estimar la distancia $D$ de frenado cuando el automóvil se esta desplazando a 55 m/s y a 75 m/s.
		\item \textbf{c)} Grafique la paráboa y los puntos de la tabla en un mismo plano cartesiano.
	\end{itemize}
\end{center}

Para resolver este problemas haremos uso de \emph{MATLAB} de la siguiente forma. En este caso las $X$ las usaremos como $V$, mientras que los valores de $Y$ serán $D$
%Implementacion matlab1
\begin{figure}[H]
\begin{tcolorbox}[title=Problema 4: Implementación en MATLAB]
	\begin{verbatim}
		%% Declarando los arreglos de los valores
		X = [20, 30, 40, 50, 60, 70]
		Y = [54, 90, 138, 206, 292, 396]
		suma_X = 0; suma_X2 = 0;
		suma_X3 = 0; suma_X4 = 0;
		suma_Y = 0; suma_XY = 0;
		suma_X2Y = 0;
		N = length(X); % Tamaño de la matriz de X
		% Sumas de cada uno de los valores que se usaran para armar la matriz 
for i = 1: N
    suma_X = suma_X + X(i); % Suma Xi
    suma_X2 = suma_X2 + X(i) ^ 2; % Suma Xi^2
    suma_X3 = suma_X3 + X(i) ^ 3; % Suma Xi^3
    suma_X4 = suma_X4 + X(i) ^ 4; % Suma Xi^4
    suma_Y = suma_Y + Y(i); % Suma Yi
    suma_XY = suma_XY + X(i) * Y(i); % Suma Xi * Yi
    suma_X2Y = suma_X2Y + X(i) ^ 2 * Y(i); % Suma Xi^2 * Yi
end
\end{verbatim}
\end{tcolorbox}
\end{figure}
Con esto podemos armar la matriz  \texttt{M} , y la submatriz \texttt{subM}, que contendrán la matriz principal con los datos de las sumas de X, y los valores de los resultados respectivamente. A su vez, haremos uso de una matriz auxiliar \texttt{Maux} que será una copia de la matriz original, con los valores de la submatriz \texttt{subM} en una de las columnas como lo requiere el método de determinantes.
%matlab3
\begin{figure}[H]
\begin{tcolorbox}[breakable, title=Problema 4: Implementación en MATLAB]
		\begin{verbatim}
		%% Creacion de la matriz M y submatriz subM
M = [ N suma_X suma_X2; suma_X suma_X2 suma_X3; suma_X2 suma_X3 suma_X4];
subM = [suma_Y suma_XY suma_X2Y];

%% encontrando los valores de a0, a1 y a2.
for i = 1:3
    Maux = M; %matriz auxiliar copia la original
    Maux(:,i) = subM; % reemplaza los valores de la columna
    a(i) = det(Maux) / det(M); % denominador del auxiliar con el de la original
end
		\end{verbatim}
		\end{tcolorbox}
		\centering
		\includegraphics[width=2.5in]{mtz4.png}

\end{figure}
La demostración anterior queda resuelta la matriz y obtenemos los valores de $a_n$ (es de notar al lector que \textit{MATLAB} cuenta los arreglos y matrices desde el 1 por lo que \texttt{a(1)	} es igual a $a_0$) los cuales son: \par. 
\begin{align*}
a_0 &= 41.771428571430754 \\
a_1 &= -1.095714285714397 \\
a_2 &= 0.087857142857144 \\
\end{align*}
Con la matriz resuelta, junto con el arreglo con los valores de $a_0$, $a_1$ y $a_2$ podemos armar el polinomio en \textit{MATLAB} para resolver los incisos \textbf{a)} y \textbf{b)} evaluando la ecuación en los valores asignados. Por lo cual la ecuación de parábola que aproxima los datos es: 
$$P^2(x) =  41.771428571430754  - 1.095714285714397x + 0.087857142857144x^2$$ 

\begin{figure}[H]
\begin{tcolorbox}[title=Problema 4: Implementación en MATLAB]
\begin{verbatim}
syms x;
P = a(1) + a(2) * x  + a(3) * x ^ 2;
aprox = subs(P, v); % v es el valor de la velocidad al que deseamos aproximar
\end{verbatim}
\end{tcolorbox}
\end{figure}
Ahora que tenemos evaluado el polinomio que describe la parábola, podemos evaluarlo en los valores para $x=55$ y $x=75$ para obtener una aproximación de la distancia requerida a esas velocidades, propuestas por el literal \textbf{b)}. Por lo tanto obtenemos las siguientes evaluaciones en el polinomio \texttt{P} en \textit{MATLAB}:
\begin{figure}[H]
\centering
\includegraphics[width=3.5in]{res4.png}
\end{figure}
A continuación se muestra como los valores iniciales como se indica en el literal \textbf{c)} se ven sobre la parábola creada. Donde se muestran los valores iniciales sobre la parábola construida:
\begin{figure}[H]
\centering
\includegraphics[width=4in]{parab4.png}
\end{figure}

% ++++++++++++++++++++++++
% SECCION 2B
%++++++++++++++++++++++++
\subsection{Ajuste de polinomios de grado \textit{n}	 (caso general)}
Si se desea aproximar una función dada de la forma tabular (pares x, y), de un polinomio grado N se realiza un procedimiento bastante similar al caso de la parábola de mínimos cuadrados. Para esto se debe minimizar la siguiente función:
\begin{equation} \label{	equation:ajustte}
	\sum_{i=1}^{m} \quad [ a_0 + a_1x_i + a_2x_i^2 + \dots + a_nx_i^n - f(x_i)] ^ 2
\end{equation}
\par
Para minimizar la función se debe derivar parcialmente con respecto a cada coeficiente $a_i$ desde 0 hasta $n$, para luego igualar a cero cada una de las funciones que se obtengan. De esta forma se llegará al siguiente sistema de ecuaciones lineales.
\begin{align*}
	ma_0 + a_1\Sigma x + a_2\Sigma x^2 + \dots + a_n\Sigma x^n &= \Sigma y \\
	a_0\Sigma x + a_1\Sigma x^2 + a_2\Sigma x^3 + \dots + a_n\Sigma x^{n+1} &= \Sigma xy\\
	a_0\Sigma x ^2 + a_1\Sigma x^3 + a_2\Sigma x^4 + \dots + a_n\Sigma x^{n+2} &= \Sigma x^2y \\
	\dots  & \dots \\
	a_0\Sigma x^n + a_1\Sigma x^{n+1} + a_2\Sigma x^{n+2} + \dots + a_n\Sigma x^{2n} &= \Sigma  x^ny
\end{align*}
\par
Una vez obtenido este sistema de ecuaciones se puede resolver mediante matrices o cualquier otro método de resolución de sistemas de ecuaciones.
\par  Una vez encontrados los valores de todos los coeficientes se puede crear el polinomio de la forma  $p(n) = a_0 + a_1x + a_2x^2 + a_3x^3 + \dots + a_nx^n$ . Este es una expansión del método anterior que se desarrolló, puesto que a partir de esta forma general se puede obtener el caso de la parábola cuando se trabaja con un polinomio de grado $n = 2$.
\cite{nieves2011metodos}


\bibliographystyle{IEEEtran}
\bibliography{bibi}
\end{document}